(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{2346:function(e,t,s){Promise.resolve().then(s.bind(s,4748))},4748:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var r=s(7437),i=s(9466),a=s(7480),n=s(2265),c=s(4984),l=s(6648),o=s(5481),d=s(1448),h=s.n(d);let u=e=>{let{cart:t}=e,[s,i]=(0,n.useState)(t||{items:[]}),[c,d]=(0,n.useState)(t?t.totalPrice:0),[h]=(0,n.useState)(0),{toast:u}=(0,o.pm)();(0,n.useEffect)(()=>{t&&(i(t),d(t.totalPrice))},[t]);let m=(e,t)=>e.length<=t?e:e.slice(0,t)+"...",x=e=>{d(e.reduce((e,t)=>e+t.productId.price*t.quantity,0))},p=async e=>{try{let t=s.items.map(t=>t._id===e._id?{...t,quantity:t.quantity+1}:t);if(i(e=>({...e,items:t})),x(t),!(await fetch("".concat(a.Z.NEXT_PUBLIC_API_ENDPOINT,"/cart/increaseQuantity"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s.userId,productId:e.productId._id,color:e.color,size:e.size})})).ok)throw Error("Failed to increase quantity.")}catch(e){console.error("Failed to increase quantity:",e)}},f=async e=>{try{if(e.quantity>1){let t=s.items.map(t=>t._id===e._id?{...t,quantity:t.quantity-1}:t);if(i(e=>({...e,items:t})),x(t),!(await fetch("/api/decreaseQuantity",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s.userId,productId:e.productId._id,color:e.color,size:e.size})})).ok)throw Error("Failed to decrease quantity.")}}catch(e){console.error("Failed to decrease quantity:",e)}},j=()=>{u({title:"Successful",description:"Đặt h\xe0ng th\xe0nh c\xf4ng",status:"Success"})},g=async e=>{try{let t=s.items.filter(t=>t._id!==e._id);if(i(e=>({...e,items:t})),x(t),!(await fetch("".concat(a.Z.NEXT_PUBLIC_API_ENDPOINT,"/cart/removeFromCart"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s.userId,productId:e.productId._id,color:e.color,size:e.size})})).ok)throw Error("Failed to remove item from cart.")}catch(e){console.error("Failed to remove item from cart:",e)}};return(0,r.jsxs)("div",{className:"mt-5",children:[(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-4 p-5",children:[(0,r.jsx)("div",{className:"col-span-5",children:(0,r.jsx)("p",{children:"Sản phẩm"})}),(0,r.jsx)("div",{className:"col-span-2",children:(0,r.jsx)("p",{children:"Đơn gi\xe1"})}),(0,r.jsx)("div",{className:"col-span-1",children:(0,r.jsx)("p",{children:"Số lượng"})}),(0,r.jsx)("div",{className:"col-span-2 ml-8",children:(0,r.jsx)("p",{children:"Số tiền"})}),(0,r.jsx)("div",{className:"col-span-2",children:(0,r.jsx)("p",{children:"Thao t\xe1c"})})]}),s&&s.items.length>0?(0,r.jsxs)("div",{className:"py-2",children:[s.items.map(e=>(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center border-b border-gray-300 py-4",children:[(0,r.jsxs)("div",{className:"col-span-5 flex items-center",children:[(0,r.jsx)("div",{className:"w-40 h-40 relative",children:(0,r.jsx)(l.default,{src:e.productId.image[0],alt:e.productId.name,layout:"fill",objectFit:"cover"})}),(0,r.jsx)("div",{className:"ml-2",children:(0,r.jsx)("p",{className:"text-sm font-medium",children:m("".concat(e.productId.name," - ").concat(e.productId.attribute),70)})})]}),(0,r.jsx)("div",{className:"col-span-2",children:(0,r.jsxs)("p",{className:"text-gray-600",children:[e.productId.price.toLocaleString()," VND"]})}),(0,r.jsxs)("div",{className:"col-span-1 flex items-center mr-8",children:[(0,r.jsx)("button",{onClick:()=>f(e),className:"bg-gray-200 text-gray-700 px-3 py-1 rounded-l focus:outline-none",children:"-"}),(0,r.jsx)("p",{className:"text-gray-600 mx-2",children:e.quantity}),(0,r.jsx)("button",{onClick:()=>p(e),className:"bg-gray-200 text-gray-700 px-3 py-1 rounded-r focus:outline-none",children:"+"})]}),(0,r.jsx)("div",{className:"col-span-2 ml-5",children:(0,r.jsxs)("p",{className:"text-gray-600",children:[(e.productId.price*e.quantity).toLocaleString()," VND"]})}),(0,r.jsx)("div",{className:"col-span-2",children:(0,r.jsx)("button",{onClick:()=>g(e),className:"bg-red-500 text-white px-3 py-1 rounded",children:"X\xf3a"})}),(0,r.jsxs)("div",{className:"col-span-12 flex flex-row items-center ml-5 w-full",children:[(0,r.jsxs)("p",{className:"text-gray-600 text-sm",children:["M\xe0u sắc: ",e.color]}),(0,r.jsxs)("p",{className:"text-gray-600 ml-2 text-sm",children:["K\xedch cỡ: ",e.size]})]})]},e._id)),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"my-2",children:[(0,r.jsx)("label",{className:"block",children:"M\xe3 Coupon:"}),(0,r.jsxs)("select",{className:"border border-gray-300 p-2",children:[(0,r.jsx)("option",{children:"--Chọn--"}),(0,r.jsx)("option",{children:"Sử dụng điểm (Điểm của bạn: 00)"})]})]}),(0,r.jsxs)("div",{className:"flex justify-between my-2",children:[(0,r.jsx)("span",{children:"Tổng tiền h\xe0ng"}),(0,r.jsxs)("span",{children:[c.toLocaleString()," đ"]})]}),(0,r.jsxs)("div",{className:"flex justify-between my-2",children:[(0,r.jsx)("span",{children:"Giảm gi\xe1 sản phẩm"}),(0,r.jsx)("span",{children:"-0 đ"})]}),(0,r.jsxs)("div",{className:"flex justify-between my-2",children:[(0,r.jsx)("span",{children:"Giảm gi\xe1 coupon"}),(0,r.jsxs)("span",{children:["- ",h.toLocaleString()," đ"]})]}),(0,r.jsxs)("div",{className:"flex justify-between my-2",children:[(0,r.jsx)("span",{children:"Ph\xed vận chuyển"}),(0,r.jsxs)("span",{children:[0..toLocaleString()," đ"]})]}),(0,r.jsxs)("div",{className:"flex justify-between my-2 font-semibold",children:[(0,r.jsx)("span",{children:"TỔNG"}),(0,r.jsxs)("span",{children:[(c-h+0).toLocaleString()," đ"]})]}),(0,r.jsxs)("div",{className:"flex flex-row mt-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"TH\xd4NG TIN VẬN CHUYỂN"}),(0,r.jsx)("button",{className:"text-blue-500 underline",children:"Thay đổi th\xf4ng tin nhận h\xe0ng"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("p",{children:"Người nhận: Trần Ngọc T\xfa"}),(0,r.jsx)("p",{children:"Điện thoại: "}),(0,r.jsx)("p",{children:"Địa chỉ: "})]})]}),(0,r.jsx)("button",{onClick:()=>j(),className:"bg-red-500 w-44 text-white px-4 py-2 rounded-md hover:bg-red-600 transition duration-300 ease-in-out h-10 ml-auto self-end",children:"Đặt h\xe0ng"})]})]})]}):(0,r.jsx)("div",{className:"py-4 px-36 text-center",children:(0,r.jsx)("p",{className:"text-xl font-semibold mb-64",children:"Giỏ h\xe0ng của bạn đang trống"})})]})};u.propTypes={cart:h().shape({userId:h().string,items:h().arrayOf(h().shape({_id:h().string.isRequired,productId:h().shape({_id:h().string.isRequired,name:h().string.isRequired,attribute:h().string.isRequired,image:h().arrayOf(h().string).isRequired,price:h().number.isRequired}).isRequired,color:h().string.isRequired,size:h().string.isRequired,quantity:h().number.isRequired})),totalPrice:h().number})};var m=s(4780);function x(){let{user:e}=(0,c.Z)(),[t,s]=(0,n.useState)();return(0,n.useEffect)(()=>{(async()=>{if(e&&e._id)try{let t=await fetch("".concat(a.Z.NEXT_PUBLIC_API_ENDPOINT,"/cart/getCart"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e._id})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to fetch cart.")}let r=await t.json();s(r),console.log(r)}catch(e){console.error("Error fetching categories:",e)}})()},[e]),console.log(t),(0,r.jsxs)("div",{children:[(0,r.jsx)(i.default,{}),(0,r.jsxs)("div",{className:"px-48 pt-32",children:[(0,r.jsx)("text",{children:"Trang chủ | Giỏ h\xe0ng"}),(0,r.jsx)(u,{cart:t}),(0,r.jsx)(m.Z,{})]})]})}},4984:function(e,t,s){"use strict";var r=s(2265);t.Z=()=>{let[e,t]=(0,r.useState)(null),[s,i]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/user");if(!e.ok)throw Error("Network response was not ok");let s=await e.json();t(s)}catch(e){i(e.message),console.error("Error fetching user:",e)}})()},[]),{user:e,error:s}}},4780:function(e,t,s){"use strict";var r=s(7437);s(2265),t.Z=()=>(0,r.jsx)("footer",{className:"bg-black text-white py-6 px-4 mt-20",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"HỆ THỐNG CỬA H\xc0NG"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-base font-semibold mb-2",children:"KHU VỰC TPHCM"}),(0,r.jsxs)("ul",{className:"list-disc list-inside",children:[(0,r.jsxs)("li",{children:["414-416 Nguyễn Tr\xe3i, P.8, Q5."," ",(0,r.jsx)("a",{href:"#",className:"text-gray-300 hover:text-white transition duration-300 ease-in-out",children:"Xem bản đồ"})]}),(0,r.jsxs)("li",{children:["96 Nguyễn Tr\xe3i, P3, Q5."," ",(0,r.jsx)("a",{href:"#",className:"text-gray-300 hover:text-white transition duration-300 ease-in-out",children:"Xem bản đồ"})]}),(0,r.jsxs)("li",{children:["214 Nguyễn Tr\xe3i, P.Nguyễn Cư Trinh, Q1."," ",(0,r.jsx)("a",{href:"#",className:"text-gray-300 hover:text-white transition duration-300 ease-in-out",children:"Xem bản đồ"})]}),(0,r.jsxs)("li",{children:["126 Hậu Giang, P.6, Q6."," ",(0,r.jsx)("a",{href:"#",className:"text-gray-300 hover:text-white transition duration-300 ease-in-out",children:"Xem bản đồ"})]}),(0,r.jsxs)("li",{children:["124 Nguyễn Thị Thập, P.B\xecnh Thuận, Q7."," ",(0,r.jsx)("a",{href:"#",className:"text-gray-300 hover:text-white transition duration-300 ease-in-out",children:"Xem bản đồ"})]})]})]}),(0,r.jsx)("div",{className:"flex justify-center mt-6",children:(0,r.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,r.jsx)("div",{className:"text-sm text-gray-300",children:"\xa9 2024 Shop Gi\xe0y MWC. All rights reserved."}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("a",{href:"#",className:"text-gray-300 hover:text-white transition duration-300 ease-in-out",children:"Privacy Policy"}),(0,r.jsx)("a",{href:"#",className:"text-gray-300 hover:text-white transition duration-300 ease-in-out",children:"Terms of Service"})]})]})]})})},9466:function(e,t,s){"use strict";s.d(t,{default:function(){return d}});var r=s(7437),i=s(2265),a=s(7138),n=s(6648),c=s(4008),l=()=>{let[e,t]=(0,i.useState)("");return(0,r.jsxs)("form",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Search...",className:"border border-gray-300 px-4 py-2 rounded-l-md focus:outline-none focus:border-blue-500"}),(0,r.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-6 py-4 rounded-r-md focus:outline-none hover:bg-blue-600",children:(0,r.jsx)(c.G4C,{})})]})},o=s(7480),d=()=>{let[e,t]=(0,i.useState)([]),[s,c]=(0,i.useState)(null),[d,h]=(0,i.useState)(!1),[u,m]=(0,i.useState)(""),x=e=>{c(e)},p=()=>{c(null)};return(0,i.useEffect)(()=>{let e=()=>{h(window.scrollY>0)};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[]),(0,i.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(o.Z.NEXT_PUBLIC_API_ENDPOINT,"/cate/AllCategories"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to fetch categories.")}let s=await e.json();t(s),m("")}catch(e){console.error("Error fetching categories:",e),m(e.message||"Failed to fetch categories.")}})()},[]),console.log(u),(0,r.jsx)("header",{className:"fixed w-full top-0 z-50 ".concat(d?"bg-white shadow-lg":"bg-transparent"),children:(0,r.jsxs)("div",{className:"flex justify-between items-center px-4 py-2",children:[(0,r.jsx)("div",{className:"w-48 md:w-auto",children:(0,r.jsx)(a.default,{href:"/",children:(0,r.jsx)(n.default,{src:"https://mwc.com.vn/Assets/App/images/logo.png",alt:"Logo",width:122,height:54,className:"object-contain"})})}),(0,r.jsx)("ul",{className:"hidden md:flex flex-row space-x-5",children:e.map(e=>(0,r.jsxs)("li",{onMouseEnter:()=>x(e.cateID),onMouseLeave:p,children:[(0,r.jsx)(a.default,{href:"/collection/".concat(e._id),children:(0,r.jsx)("span",{className:"font-semibold cursor-pointer hover:text-blue-500",children:e.cateName})}),e.subCategories.length>0&&s===e.cateID&&(0,r.jsx)("ul",{className:"absolute z-10 p-4 bg-white shadow-lg",children:e.subCategories.map(e=>(0,r.jsx)("li",{className:"py-1",children:(0,r.jsx)(a.default,{href:"/collection/".concat(e._id),children:(0,r.jsx)("span",{className:"text-base text-black-700 hover:text-blue-500 font-semibold",children:e.subcateName})})},e._id))})]},e._id))}),(0,r.jsxs)("div",{className:"flex space-x-5 items-center",children:[(0,r.jsx)(l,{}),(0,r.jsx)(a.default,{href:"/profile",children:(0,r.jsx)(n.default,{src:"/images/user.svg",alt:"User Icon",width:24,height:24})}),(0,r.jsx)("div",{children:(0,r.jsx)(a.default,{href:"/cart",children:(0,r.jsx)(n.default,{src:"/images/shopping-cart.svg",alt:"Shopping Cart Icon",width:24,height:24})})})]})]})})}},5481:function(e,t,s){"use strict";s.d(t,{pm:function(){return u}});var r=s(2265);console.log({ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"});let i=0,a=new Map,n=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},c=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],o={toasts:[]};function d(e){o=c(o,e),l.forEach(e=>{e(o)})}function h(e){let{...t}=e,s=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function u(){let[e,t]=r.useState(o);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:h,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},7480:function(e,t,s){"use strict";var r=s(9772);let i=r.z.object({NEXT_PUBLIC_API_ENDPOINT:r.z.string()}).safeParse({NEXT_PUBLIC_API_ENDPOINT:"https://tranngoctu05.id.vn"});if(!i.success)throw Error("C\xe1c gi\xe1 trị khai b\xe1o trong env kh\xf4ng đ\xfang");let a=i.data;t.Z=a},9949:function(e,t,s){"use strict";var r=s(8877);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,s,i,a,n){if(n!==r){var c=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return s.PropTypes=s,s}},1448:function(e,t,s){e.exports=s(9949)()},8877:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},function(e){e.O(0,[422,751,49,971,23,744],function(){return e(e.s=2346)}),_N_E=e.O()}]);